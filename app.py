import streamlit as st
import pandas as pd
import time
import random

# ==========================================
# 1. ç³»çµ±è¨­å®šèˆ‡è³‡æ–™åº« (System Config & Data)
# ==========================================
st.set_page_config(
    page_title="é˜¿ç¾æ—æ¼çµæ–‡åŒ–æ•™å­¸ç³»çµ±",
    page_icon="ğŸŸ",
    layout="wide",
    initial_sidebar_state="expanded"
)

# æ¨¡æ“¬è³‡æ–™åº«ï¼šé˜¿ç¾èªè©å½™
VOCABULARY = {
    "foting": "é­š",
    "'afar": "è¦",
    "kalang": "èŸ¹",
    "riyar": "æµ·æ´‹",
    "'alo": "æ²³æµ",
    "mifoting": "æ•é­š",
    "mipaliw": "äº’åŠ©/æ›å·¥",
    "rakar": "é­šç­Œ (é™·é˜±)",
    "tafokod": "å…«å¦ç¶²",
    "paysin": "ç¦å¿Œ/è¦çŸ©",
    "mato'asay": "é•·è€/é ˜å°è€…" # <--- æ–°å¢è©å½™
}

# æ¨¡æ“¬è³‡æ–™åº«ï¼šæ•™æ¡ˆå…§å®¹ (ç´°ç¯€å¼·åŒ–ç‰ˆæœ¬)
LESSON_PLANS = {
    "ä½å¹´ç´šæ•™æ¡ˆ": [
        {"Title": "L1 å¤§æµ·æ˜¯å€‹å¤§å†°ç®±", "Obj": "èªè­˜ç’°å¢ƒï¼Œèƒ½é‡æ¦‚å¿µ", "Act": "æ•…äº‹æ™‚é–“ï¼šè¬›è¿°é˜¿ç¾æ—å­©å­åœ¨æºªé‚Šçš„æ•…äº‹ï¼Œå­¸ç¿’ riyarï¼ˆæµ·ï¼‰å’Œ 'aloï¼ˆæ²³ï¼‰ã€‚è¨è«–ã€Œåƒé­šå°±æ˜¯å¾—åˆ°é­šçš„èƒ½é‡ã€ã€‚"},
        {"Title": "L2 é­šå…’é»é»å", "Obj": "èªè­˜é£Ÿç‰©èˆ‡èƒ½é‡ï¼Œæ„Ÿå®˜åˆ†é¡", "Act": "æ„Ÿå®˜é«”é©—ï¼šæ‘¸é­šé±—/èŸ¹æ®¼çš„è§¸æ„Ÿã€‚å­¸ç¿’èªªå‡º fotingï¼ˆé­šï¼‰å’Œ 'afarï¼ˆè¦ï¼‰ä¸¦æ­é…å‹•ä½œã€‚"},
        {"Title": "L3 å®‰éœï¼é­šæœƒè½è¦‹", "Obj": "è¦çŸ©èˆ‡å°ˆæ³¨ï¼Œè¨Šè™Ÿèˆ‡å™ªè²", "Act": "éŠæˆ²ï¼šã€Œé­šåœ¨è½ã€ã€‚ç•¶è€å¸«è½‰éèº«æ™‚ï¼Œå­¸ç”Ÿå¿…é ˆä¿æŒéœæ­¢ä¸å‹•ã€‚ç†è§£å¤§è²åµé¬§æœƒåš‡è·‘é­šå…’ã€‚"},
        {"Title": "L4 å°å°æ¼å¤«å‹•æ‰‹åš", "Obj": "å‹•æ‰‹å˜—è©¦ï¼Œèƒ½é‡è¼¸å‡º", "Act": "æ“ä½œé«”é©—ï¼šä½¿ç”¨ç¶²å‹ºæ’ˆå–æ°´ä¸­çš„ç©å…·é­šã€‚é‡é»åœ¨æ–¼å‹•ä½œçš„ç²¾æº–åº¦èˆ‡æ‰‹çœ¼å”èª¿ã€‚ç·´ç¿’æ¨¡ä»¿æ’’ç¶²çš„å‹•ä½œã€‚"},
        {"Title": "L5 å¤§å®¶ä¸€èµ·åƒ", "Obj": "åˆ†äº«èˆ‡æ„›ï¼Œæ­£å‘å›é¥‹", "Act": "æƒ…å¢ƒæ¨¡æ“¬ï¼šæ•åˆ°çš„ã€Œé­šã€ï¼ˆé¤…ä¹¾æˆ–ç³–æœï¼‰è¦å…ˆåˆ†çµ¦é•·è¼©å’Œæœ‹å‹ã€‚ç†è§£åˆ†äº«æœƒè®“å‹èª¼çš„ç¶²çµ¡æ›´å¼·ã€‚"},
        {"Title": "L6 Mallah æ´¾å°", "Obj": "æ–‡åŒ–é€£çµï¼Œå»ºç«‹ç¶²çµ¡é€£çµ", "Act": "æ–‡åŒ–é«”é©—ï¼šå…¨ç­åœåæˆåœ“åœˆï¼Œè€å¸«è§£é‡‹ Mallahï¼ˆåœ˜èšï¼‰ä»£è¡¨çš„æ„ç¾©æ˜¯ã€Œæˆ‘å€‘æ˜¯ä¸€å®¶äººã€ã€‚"}
    ],
    "ä¸­å¹´ç´šæ•™æ¡ˆ": [
        {"Title": "L1 å­£ç¯€çš„æ™‚é˜", "Obj": "ç”Ÿæ…‹æ™‚åºï¼Œè³‡æºæµå‹•", "Act": "è£½ä½œã€Œé­šçš„æ´„æ¸¸è·¯ç·šåœ–ã€ã€‚é‡é»æ¨™è¨»é­šé¡ç¹æ®–æœŸï¼ˆä¼‘æ¼æœŸï¼‰ï¼Œç†è§£ä¸æ•æ’ˆå°é­šæ˜¯ç‚ºäº†ç¢ºä¿æ˜å¹´çš„è³‡æºæµå‹•ã€‚"},
        {"Title": "L2 å·¥å…·å¤§æ­å¯†", "Obj": "å·¥å…·åŸç†ï¼Œæœ€å°é˜»åŠ›è·¯å¾‘", "Act": "åŸç†åˆ†æï¼šæ·±å…¥è§€å¯Ÿé­šç­Œï¼ˆRakarï¼‰çš„æ§‹é€ ç´°ç¯€ï¼Œè¨è«–ç«¹æ¢å¦‚ä½•ç·¨ç¹”æˆå–®å‘å…¥å£ï¼Œå¯¦ç¾ã€Œåªé€²ä¸å‡ºã€çš„é™·é˜±é‚è¼¯ã€‚"},
        {"Title": "L3 é™·é˜±å·¥ç¨‹å¸«(ä¸Š)", "Obj": "PBLå¯¦ä½œï¼Œç¶²çµ¡ç¯€é»", "Act": "è¨­è¨ˆè‰åœ–ï¼šç¹ªè£½æ¨¡æ“¬æ²³é“åœ°å½¢ã€‚è¨è«–é­šæœƒåœ¨å“ªè£¡ä¼‘æ¯ï¼Ÿå“ªè£¡çš„æ°´æµæœ€é©åˆä½ˆç½®é™·é˜±ï¼Ÿé€™å°±æ˜¯å°‹æ‰¾ã€Œé«˜æµé‡ç¯€é»ã€ã€‚"},
        {"Title": "L4 é™·é˜±å·¥ç¨‹å¸«(ä¸‹)", "Obj": "PBLå¯¦ä½œï¼Œè©¦éŒ¯èˆ‡å„ªåŒ–", "Act": "å¯¦ä½œå„ªåŒ–ï¼šç”¨å›æ”¶ææ–™è£½ä½œé­šç­Œæ¨¡å‹ä¸¦æ¸¬è©¦ã€‚å°çµ„åˆ†äº«å¦‚ä½•ä¿®æ­£ï¼Œä½¿å…¶æ›´ç¬¦åˆæ°´æµåŸç†ï¼Œæé«˜æ•ç²ç‡ã€‚"},
        {"Title": "L5 è¶…ç´šåœ˜éšŠ Mipaliw", "Obj": "åœ˜éšŠåˆ†å·¥ï¼Œç¶²çµ¡å¸¶å¯¬", "Act": "éŠæˆ²ï¼šæ¨¡æ“¬ã€Œè¶•é­šèˆ‡åœæ•ã€ã€‚å¼·èª¿è¶•é­šè€…çš„è¨Šè™Ÿå¿…é ˆæ¸…æ™°ï¼ˆæŒ‡ä»¤ï¼‰ï¼Œæ’’ç¶²è€…è¦å¿«é€ŸéŸ¿æ‡‰ï¼ˆä½å»¶é²ï¼‰ï¼Œæ‰èƒ½é”åˆ°æœ€å¤§æ•ç²æ•ˆç‡ã€‚"},
        {"Title": "L6 æ¼ç²æ€éº¼åˆ†ï¼Ÿ", "Obj": "åˆ†äº«äº¤æ›ï¼Œå…¬å¹³åˆ†é…", "Act": "è¨è«–ï¼šå¦‚æœåªåˆ†çµ¦æŠ“é­šçš„äººï¼Œç”Ÿç—…æˆ–å—å‚·çš„äººæ€éº¼è¾¦ï¼Ÿç†è§£å¹³å‡åˆ†é…æ˜¯ç‚ºäº†éƒ¨è½çš„æŒçºŒé‹ä½œã€‚å­¸ç¿’å°‡é£Ÿç‰©åˆ†çµ¦é•·è¼©çš„ç¦®å„€ã€‚"}
    ],
    "é«˜å¹´ç´šæ•™æ¡ˆ": [
        {"Title": "L1 å—å³¶çš„åŸºå› ", "Core_Idea": "éƒ¨è½äº’åŠ©çš„åŠ›é‡ (ç¶²çµ¡æ‹“æ’²)", "Obj": "åœ°ç†èˆ‡åŸºå› ï¼Œå¼·é€£çµç‰¹æ€§", "Act": "åœ°åœ–åˆ†æï¼šåˆ†æå—å³¶èªæ—æ“´æ•£çš„åœ°åœ– ã€‚è¨è«–é˜¿ç¾æ—ç¤¾æœƒéšå±¤ï¼ˆå¦‚ Kapah é’å£¯å¹´ã€mato'asay é•·è€ï¼‰åœ¨æ¼çµä¸­çš„ç¶²çµ¡åˆ†å·¥ã€‚"}, # <--- å·²æ›´æ–°
        {"Title": "L2 è¦çŸ©èˆ‡æ™ºæ…§", "Core_Idea": "ç¥–å…ˆçš„ç”Ÿå­˜æ™ºæ…§ (é¢¨éšªç®¡ç†)", "Obj": "æ‰¹åˆ¤æ€è€ƒï¼Œé¢¨éšªæ¥µå°åŒ–ç­–ç•¥", "Act": "æ·±ç©¶ Paysinï¼ˆç¦å¿Œï¼‰èˆ‡ç¾ä»£å®‰å…¨è¦ç¯„çš„ç•°åŒã€‚è¨è«–ç‚ºä½•å‚³çµ±è¦å®šå¥³æ€§ä¸èƒ½é è¿‘æ¼çµå ´åœ°ï¼ˆè§£é‡‹ç‚ºä¿è­·é«˜é¢¨éšªä½œæ¥­çš„å°ˆæ³¨åº¦å’ŒåŠƒåˆ†è·è²¬ï¼‰ã€‚"},
        {"Title": "L3 ç‰©ç†èˆ‡åŠ›å­¸", "Core_Idea": "å¤§è‡ªç„¶æ°¸çºŒçš„è¦å‰‡ (èƒ½é‡è½‰æ›)", "Obj": "ç§‘å­¸åŸç†ï¼Œèƒ½é‡è½‰æ›æ•ˆç‡", "Act": "æ¡ˆä¾‹åˆ†æï¼šå…«å¦ç¶²ï¼ˆTafokodï¼‰çš„æ§‹é€ ç´°ç¯€ã€‚ç¶²é‚Šçš„é‰›å¢œå¦‚ä½•é€éæ…£æ€§èˆ‡é›¢å¿ƒåŠ›ï¼Œè®“ç¶²é¢åœ¨æ°´ä¸­å‡å‹»å±•é–‹ï¼Ÿè¨è«–å…¶é«˜æ•ˆç¯€èƒ½æ€§ã€‚"},
        {"Title": "L4 å…¬åœ°æ‚²åŠ‡", "Core_Idea": "å¤§è‡ªç„¶æ°¸çºŒçš„è¦å‰‡ (è³‡æºä¿è­·)", "Obj": "è³½å±€ç†è«–ï¼Œå°æŠ—è³‡æºè€—ç«­", "Act": "è³½å±€å¯¦é©—ï¼šé€²è¡Œè³‡æºæœ‰é™æ€§æ¨¡æ“¬éŠæˆ²ã€‚è¨è«–æ°£å€™è®Šé·ä¸‹ï¼Œç¾ä»£ç¤¾æœƒå¦‚ä½•å¾é˜¿ç¾æ—çš„ã€Œä¸è²ªå©ªã€å“²å­¸ä¸­å­¸ç¿’è³‡æºåˆ†é…ã€‚"},
        {"Title": "L5 ç¤¾æœƒå®‰å…¨ç¶²", "Core_Idea": "éƒ¨è½äº’åŠ©çš„åŠ›é‡ (å†—é¤˜ç”Ÿå­˜)", "Obj": "ç¤¾æœƒæ­£ç¾©ï¼Œå†—é¤˜ç”Ÿå­˜ç­–ç•¥", "Act": "åˆ†é…èˆ‡æ­£ç¾©ï¼šæ¨¡æ“¬åˆ†é…é­šè²¨ã€‚æ·±å…¥è¨è«– Mipaliw äº’åŠ©ç²¾ç¥å¦‚ä½•å»ºç«‹ç¤¾æœƒè³‡æœ¬ï¼Œç¢ºä¿é•·è€…å’Œå¼±å‹¢ç¯€é»åœ¨ç¶²çµ¡ä¸­ä¸æœƒè¢«å­¤ç«‹ã€‚"},
        {"Title": "L6 æ°¸çºŒå®£è¨€", "Core_Idea": "ç¥–å…ˆçš„ç”Ÿå­˜æ™ºæ…§ (é©æ‡‰èˆ‡é€²åŒ–)", "Obj": "åæ€æ‡‰ç”¨ï¼Œé«˜æ•ˆç‡é‹ç®—", "Act": "PBL æœ€çµ‚ç”¢å‡ºï¼šè®“å­¸ç”Ÿæ’°å¯«ä¸€ä»½ç¾ä»£ç”Ÿæ´»çš„ã€Œè‡ªç„¶å…¬ç´„ã€ï¼Œæ¶µè“‹è³‡æºä½¿ç”¨è¦ç¯„èˆ‡éƒ¨è½äº’åŠ©åŸå‰‡ã€‚"}
    ]
}

# ==========================================
# 2. ä»‹é¢è¨­è¨ˆ (UI Layout)
# ==========================================

# å´é‚Šæ¬„å°èˆª
with st.sidebar:
    st.title("ğŸ¹ æ¼çµæ–‡åŒ–æ•™å­¸å°èˆª")
    mode = st.radio(
        "é¸æ“‡åŠŸèƒ½æ¨¡çµ„ï¼š",
        ["ğŸ  é¦–é èˆ‡ç†å¿µ", "ğŸŸ¢ ä½å¹´ç´šæ•™æ¡ˆ", "ğŸŸ¡ ä¸­å¹´ç´šæ•™æ¡ˆ", "ğŸ”´ é«˜å¹´ç´šæ•™æ¡ˆ", "ğŸ› ï¸ æ•¸ä½æ•™å…·ç®±", "ğŸ“š æ—èªå–®å­—å¡"]
    )
    st.info("ğŸ’¡ æç¤ºï¼šæœ¬ç³»çµ±å°ˆç‚ºæ•™å¸«è¨­è¨ˆï¼Œçµåˆ PBL èˆ‡è·¨é ˜åŸŸæ•™å­¸ã€‚")

# --- ğŸ  é¦–é  ---
if mode == "ğŸ  é¦–é èˆ‡ç†å¿µ":
    st.title("Mifoting çš„æ™ºæ…§ï¼šæµ·æ´‹èˆ‡åœŸåœ°çš„å”å®š")
    st.subheader("é˜¿ç¾æ—æ¼çµæ–‡åŒ–è·¨é ˜åŸŸæ•™å­¸ç³»çµ±")
    
    st.markdown("""
    ### æ ¸å¿ƒæ•™å­¸ç†å¿µ (ç¥–å…ˆçš„ç”Ÿå­˜é‚è¼¯)
    æœ¬æ•™æ¡ˆä¸åªæ˜¯ä»‹ç´¹ã€Œå¦‚ä½•æ•é­šã€ï¼Œè€Œæ˜¯è§£æ§‹é˜¿ç¾æ—ç”Ÿå­˜èƒŒå¾Œçš„**åº•å±¤æ™ºæ…§**ï¼š
    
    * **ğŸŒŠ æµå‹• (Flow)**ï¼šé †æ‡‰å­£ç¯€ï¼Œæ°¸çºŒåˆ©ç”¨ï¼Œç¬¦åˆ**å¤§è‡ªç„¶æ°¸çºŒçš„è¦å‰‡**ã€‚
    * **ğŸ•¸ï¸ é€£çµ (Position)**ï¼šé€éåˆ†äº«å»ºç«‹ç¤¾æœƒäº’åŠ©ï¼Œå¼·åŒ–**éƒ¨è½äº’åŠ©çš„åŠ›é‡**ã€‚
    * **ğŸ›¡ï¸ è¦çŸ© (Rule)**ï¼šç¦å¿Œ (Paysin) æ˜¯å¤è€çš„**é¢¨éšªæ¥µå°åŒ–**æ¼”ç®—æ³•ï¼Œé«”ç¾**ç¥–å…ˆçš„ç”Ÿå­˜æ™ºæ…§**ã€‚
    
    ### ä½¿ç”¨èªªæ˜
    1. é¸æ“‡å·¦å´å°æ‡‰å¹´ç´šã€‚
    2. ä¾ç…§ 6 ç¯€èª²æµç¨‹é€²è¡Œæ•™å­¸ã€‚
    3. ä½¿ç”¨ã€Œæ•¸ä½æ•™å…·ç®±ã€é€²è¡Œäº’å‹•æ¼”ç¤ºã€‚
    """)
    st.image("https://images.unsplash.com/photo-1544551763-46a013bb70d5?q=80&w=2070&auto=format&fit=crop", caption="é †æ‡‰è‡ªç„¶çš„æ™ºæ…§ (ç¤ºæ„åœ–)", use_col_width=True)

# --- ğŸŸ¢ğŸŸ¡ğŸ”´ å„å¹´ç´šæ•™æ¡ˆå±•ç¤º ---
elif "æ•™æ¡ˆ" in mode:
    grade_level = mode
    st.title(f"{grade_level} - æ•™å­¸æµç¨‹è¡¨")
    
    # ç§»é™¤é–‹é ­çš„è¡¨æƒ…ç¬¦è™Ÿå’Œç©ºæ ¼ï¼Œåªç•™ä¸‹ 'ä½å¹´ç´šæ•™æ¡ˆ'
    try:
        clean_key = grade_level.split(" ", 1)[-1]
        lessons = LESSON_PLANS[clean_key]
    except KeyError:
        st.error(f"**éŒ¯èª¤ï¼** æ‰¾ä¸åˆ°æ•™æ¡ˆå…§å®¹ã€‚è«‹æª¢æŸ¥æ•¸æ“šåº« Key: {clean_key}")
        st.stop()
    
    # å»ºç«‹ Tabs
    tabs = st.tabs([f"ç¬¬ {i+1} ç¯€" for i in range(6)])
    
    for i, tab in enumerate(tabs):
        with tab:
            lesson = lessons[i]
            st.header(f"ç¬¬ {i+1} ç¯€ï¼š{lesson['Title']}")
            
            # é«˜å¹´ç´šç‰¹æœ‰çš„æ ¸å¿ƒæ¦‚å¿µé¡¯ç¤º
            if 'Core_Idea' in lesson:
                st.info(f"ğŸ’¡ **æ ¸å¿ƒæ¦‚å¿µ**ï¼š{lesson['Core_Idea']}")
            
            col1, col2 = st.columns([1, 2])
            with col1:
                st.markdown(f"**ğŸ¯ å­¸ç¿’ç›®æ¨™**\n\n{lesson['Obj']}")
                st.markdown(f"**â±ï¸ å»ºè­°æ™‚é–“**\n\n40 åˆ†é˜")
            with col2:
                st.markdown(f"**ğŸ¬ ä¸»è¦æ´»å‹•**\n\n{lesson['Act']}")
                
            st.markdown("---")
            st.write("ğŸ“ **æ•™å¸«å‚™èª²ç­†è¨˜å€** (å¯åœ¨æ­¤è¼¸å…¥é‡é»):")
            st.text_area(f"L{i+1}_notes_{grade_level}", placeholder="ä¾‹å¦‚ï¼šè¨˜å¾—æº–å‚™ç›¸é—œçš„åœ–æ–‡è³‡æ–™ä»¥è¼”åŠ©æ•™å­¸...", height=100)

# --- ğŸ› ï¸ æ•¸ä½æ•™å…·ç®± (äº’å‹•åŠŸèƒ½æ ¸å¿ƒ) ---
elif mode == "ğŸ› ï¸ æ•¸ä½æ•™å…·ç®±":
    st.title("ğŸ› ï¸ æ•™å¸«å°ˆç”¨ï¼šæ•¸ä½æ•™å…·ç®±")
    
    tool_choice = st.selectbox("é¸æ“‡æ•™å…·ï¼š", ["âš–ï¸ æ¼ç²åˆ†é…è¨ˆç®—æ©Ÿ (é«˜å¹´ç´š)", "ğŸ“… å­£ç¯€è¦çŸ©è½‰ç›¤ (ä¸­å¹´ç´š)", "ğŸ”‡ è²é‡ç›£æ¸¬å™¨ (ä½å¹´ç´š)"])
    
    # Tool 1: åˆ†é…è¨ˆç®—æ©Ÿ (é«˜å¹´ç´š L5 - éƒ¨è½äº’åŠ©çš„åŠ›é‡)
    if "åˆ†é…è¨ˆç®—æ©Ÿ" in tool_choice:
        st.subheader("ğŸŸ é˜¿ç¾æ—ç¤¾æœƒå®‰å…¨ç¶² - åˆ†é…æ¨¡æ“¬å™¨ (éƒ¨è½äº’åŠ©çš„åŠ›é‡)")
        st.markdown("æ­¤å·¥å…·æ¨¡æ“¬å‚³çµ±åˆ†é…æ©Ÿåˆ¶ï¼Œç¢ºä¿éƒ¨è½æ•´é«”ç”Ÿå­˜çš„**å†—é¤˜æ€§**ã€‚")
        
        total_catch = st.number_input("è¼¸å…¥ä»Šæ—¥ç¸½æ¼ç²é‡ (å…¬æ–¤):", min_value=0, value=100)
        
        if st.button("é–‹å§‹åˆ†é…"):
            # æ¨¡æ“¬ç®—æ³• (15% æ•¬è€, 10% å¼±å‹¢, 75% å‹å‹•è€…å‡åˆ†)
            elder_share = total_catch * 0.15
            welfare_share = total_catch * 0.10
            worker_share = total_catch - elder_share - welfare_share
            
            col1, col2, col3 = st.columns(3)
            # <--- é•·è€ç¨±è¬‚æ›´æ–°è™•
            col1.metric("æ•¬è€ (mato'asay)", f"{elder_share:.1f} kg", "å„ªå…ˆåˆ†é… (æ™ºæ…§å‚³æ‰¿)") 
            col2.metric("å‹å‹•è€… (å‡åˆ†)", f"{worker_share:.1f} kg", "å¤šå‹å¤šå¾— (èƒ½é‡è¼¸å‡º)")
            col3.metric("ç¤¾æœƒç¦åˆ© (å¼±å‹¢)", f"{welfare_share:.1f} kg", "ç…§é¡§å­¤å¯¡ (ç¶²çµ¡éŸŒæ€§)")
            
            st.success("é€™å°±æ˜¯ã€å…±äº«ã€çš„æ¼”åŒ–ç­–ç•¥ï¼çŠ§ç‰²å–®æ¬¡æœ€å¤§åŒ–ï¼Œæ›å–ç¾¤é«”é•·ä¹…ç”Ÿå­˜ã€‚")

    # Tool 2: å­£ç¯€è¦çŸ©è½‰ç›¤ (ä¸­å¹´ç´š L1 - å¤§è‡ªç„¶æ°¸çºŒçš„è¦å‰‡)
    elif "å­£ç¯€è¦çŸ©" in tool_choice:
        st.subheader("ğŸ“… æ¼çµå­£ç¯€è¡Œäº‹æ›† (å¤§è‡ªç„¶æ°¸çºŒçš„è¦å‰‡)")
        st.markdown("æ­¤å·¥å…·ç”¨æ–¼å±•ç¤ºã€Œä¸æ™‚ä¸é£Ÿã€çš„ **è³‡æºæµå‹•ç®¡ç†**ï¼Œé¿å…è³‡æºè€—ç«­ã€‚")
        
        season = st.select_slider("ç¾åœ¨æ˜¯å¹¾æœˆï¼Ÿ", options=range(1, 13))
        
        if 4 <= season <= 9:
            st.success(f"{season}æœˆï¼šğŸŒŠ æ¼çµæ—ºå­£ï¼")
            st.write("æ´»å‹•ï¼šæ´„æ¸¸é­šé¡æ•æ‰ã€æº–å‚™è±å¹´ç¥­ã€‚")
            st.write("ğŸ’¡ æ ¸å¿ƒï¼šå…è¨±è³‡æº**é«˜æµå‹•**ï¼Œä½†éœ€**éµå®ˆæµé‡ä¸Šé™**ã€‚")
        else:
            st.warning(f"{season}æœˆï¼šâ›” ä¼‘é¤Šç”Ÿæ¯æœŸ")
            st.write("ä»»å‹™ï¼šè®“é­šé¡ç¹æ®–ã€ä¿®è£œæ¼å…·ã€‚")
            st.write("ğŸ’¡ æ ¸å¿ƒï¼š**é™åˆ¶æµå‹•**ï¼Œé€²è¡Œ**ç’°å¢ƒç¶­è­·**ï¼Œæ¢å¾©è³‡æºç§©åºã€‚")

    # Tool 3: è²é‡ç›£æ¸¬ (ä½å¹´ç´š L3 - ç¥–å…ˆçš„ç”Ÿå­˜æ™ºæ…§)
    elif "è²é‡ç›£æ¸¬" in tool_choice:
        st.subheader("ğŸ”‡ æ¨¡æ“¬è²é‡ç›£æ¸¬å™¨ (ç¥–å…ˆçš„ç”Ÿå­˜æ™ºæ…§)")
        st.markdown("æ­¤å·¥å…·è¨“ç·´å­¸ç”Ÿå°‡åµé¬§è²è¦–ç‚ºå½±éŸ¿æ¼çµçš„ **å™ªè²**ã€‚")
        
        if st.button("é–‹å§‹ç›£æ¸¬"):
            with st.empty():
                for i in range(5, 0, -1):
                    st.write(f"å€’æ•¸ {i} ç§’ï¼Œä¿æŒå®‰éœ...")
                    time.sleep(1)
                st.balloons()
                st.success("é­šå…’è¨Šè™Ÿæ¸…æ™°ï¼å¤§å®¶éƒ½å¾ˆå®‰éœï¼Œç”Ÿå­˜ç‡æé«˜ï¼")

# --- ğŸ“š æ—èªå–®å­—å¡ ---
elif mode == "ğŸ“š æ—èªå–®å­—å¡":
    st.title("ğŸ“š é˜¿ç¾èªæ¼çµå–®å­—å¡")
    
    # 1. åˆå§‹åŒ– session_state
    if "vocab_list" not in st.session_state:
        st.session_state["vocab_list"] = list(VOCABULARY.items())

    # 2. æŒ‰éˆ•é‚è¼¯
    if st.button("ğŸ”€ é‡æ–°æ´—ç‰Œ"):
        random.shuffle(st.session_state["vocab_list"])

    # 3. é¡¯ç¤º
    current_vocab = st.session_state["vocab_list"]
    
    col1, col2 = st.columns(2)
    half = len(current_vocab) // 2
    
    with col1:
        for word, meaning in current_vocab[:half]:
            with st.expander(f"â“ {word}"):
                st.markdown(f"### ğŸ‘‰ {meaning}")
                
    with col2:
        for word, meaning in current_vocab[half:]:
            with st.expander(f"â“ {word}"):
                st.markdown(f"### ğŸ‘‰ {meaning}")

# Footer
st.markdown("---")
st.caption("Designed with FP-CRF Logic | é˜¿ç¾æ—æ¼çµæ–‡åŒ–æ•™è‚²å°ˆæ¡ˆ")